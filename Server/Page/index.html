<!DOCTYPE html>
<html lang="es-MX">

  <head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <style>

      body {
        background-color: #070714;
        font-family: Arial, Helvetica, sans-serif;
        text-align: center;
        margin: 0 auto;
        padding: 0;
      }

      h1 {
        color: #CCC;
        font-weight: 800;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
      }

      .container {
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .image-container {
        flex: 1;
        max-width: 85%;
      }

      table {
        margin-left: auto;
        margin-right: auto;
        flex: 1;
      }

      .button {
        background-color: #0E0E2C;
        border: 3px solid #838282;
        border-radius: 15px;
        padding: 12px 12px;
        width: 65px;
        height: 65px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        outline: none;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
      }

      .button:active {
        background-color: #1D1D44;
      }

      .button:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 15px #A57AF54D;
      }

      .center {
        background-color: #101014;
        border-radius: 50%;
        width: 75px;
        height: 75px;
      }

      img {
        width: auto;
        max-width: 100%;
        height: auto;
      }

      .arrow {
        border: solid #7C3FEC;
        border-width: 0 10px 10px 0;
        display: inline-block;
        padding: 5px;
      }

      .right {
        transform: rotate(-45deg);
        -webkit-transform: rotate(-45deg);
      }

      .left {
        transform: rotate(135deg);
        -webkit-transform: rotate(135deg);
      }

      .up {
        transform: rotate(-135deg);
        -webkit-transform: rotate(-135deg);
      }

      .down {
        transform: rotate(45deg);
        -webkit-transform: rotate(45deg);
      }

      .light {
        font-size:xx-large;
        padding: 5px;
      }

      input[type="range"] {
        margin-top: 10px;
        -webkit-appearance: none;
        appearance: none;
        border-radius: 20px;
      }

      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 20px;
        height: 20px;
        background: #4409B3;
        border-radius: 50%;
        cursor: pointer;
        margin-top: -2px;
      }

      input[type="range"]::-moz-range-thumb {
        width: 20px;
        height: 20px;
        background: #4409B3;
        border-radius: 50%;
        cursor: pointer;
        margin-top: -2px;
      }

      input[type="range"]::-ms-thumb {
        width: 20px;
        height: 20px;
        background: #4409B3;
        border-radius: 50%;
        cursor: pointer;
        margin-top: -2px;
      }

      input[type="range"]::-webkit-slider-runnable-track {
        height: 16px;
        background: #B48CFF;
        border-radius: 20px;
      }

      input[type="range"]::-moz-range-track {
        height: 15px;
        background: #B48CFF;
        border-radius: 20px;
      }

      input[type="range"]::-ms-track {
        height: 16px;
        background: #B48CFF;
        border-radius: 20px;
        border: none;
        color: transparent;
      }

      #angleValue {
        color: #CCC;
        font-size: x-large;
        font-weight: 800;
      }

      @media(min-width: 900px) {
        .main-container {
          display: flex;
          flex-direction: row;
          align-items: flex-start;
        }
        td {
          padding: 24px;
        }
        input[type="range"] {
          width: 55%;
        }
      }

      @media(max-width: 900px) {
        .main-container {
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        td {
          padding: 8px;
        }
        input[type="range"] {
          width: 85%;
        }
      }

    @media (hover: none) {
      .button:hover {
        transform: none;
        box-shadow: none;
      }
      .button:active {
        background-color: #1D1D44;
        transform: scale(1.05);
        box-shadow: 0 8px 15px #A57AF54D;
      }

    }

    </style>

    <title>Dashboard ðŸŒ•</title>

  </head>

  <body>

    <h1>COLMENA ðŸ¤–</h1>

    <div class="main-container">
      
      <div class="container image-container">
        <img src="" id="photo">
      </div>

      <table>
        <tr>
          <td colspan="3" align="center">
            <button class="button" onmousedown="sendCommand('forward');" ontouchstart="sendCommand('forward');"
              onmouseup="sendCommand('stop');" ontouchend="sendCommand('stop');">
              <i class="arrow up"></i>
            </button>
          </td>
        </tr>
        <tr>
          <td align="center">
            <button class="button" onmousedown="sendCommand('left');" ontouchstart="sendCommand('left');"
              onmouseup="sendCommand('stop');" ontouchend="sendCommand('stop');">
              <i class="arrow left"></i>
            </button>
          </td>
          <td align="center">
            <button class="button center" id="flashButton" onclick="toggleFlash();"><span class="light">ðŸ’¡</span></button>
          </td>
          <td align="center">
            <button class="button" onmousedown="sendCommand('right');" ontouchstart="sendCommand('right');"
              onmouseup="sendCommand('stop');" ontouchend="sendCommand('stop');">
              <i class="arrow right"></i>
            </button>
          </td>
        </tr>
        <tr>
          <td colspan="3" align="center">
            <button class="button" onmousedown="sendCommand('backward');" ontouchstart="sendCommand('backward');"
              onmouseup="sendCommand('stop');" ontouchend="sendCommand('stop');">
              <i class="arrow down"></i>
            </button>
          </td>
        </tr>
        <tr>
          <td colspan="3" align="center">
              <input type="range" id="angleSlider" min="-45" max="45" value="0" step="5" oninput="updateAngle(this.value)" />
              <p id="angleValue">Servo: 0Â°</p>
          </td>
      </tr>
      </table>

    </div>

    <script>

      let flashOn = false;

      function sendCommand(action) {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "/action?go=" + action, true);
        xhr.send();
      }

      function toggleFlash() {

        flashOn = !flashOn;

        const button = document.getElementById("flashButton");

        if (flashOn) {
          sendCommand("flash-on");
          button.style.backgroundColor = "#F4F4F4";
        } else {
          sendCommand("flash-off");
          button.style.backgroundColor = "#101014"; 
        }

      }

      function updateAngle(value) {
        document.getElementById('angleValue').innerText = "Servo: " + value + "Â°";
        sendCommand("servo-" + value);
      }

      window.onload = function() {

        const button = document.getElementById("flashButton");
        sendCommand("flash-off");

        const slider = document.getElementById('angleValue');
        sendCommand("servo-0");

        document.getElementById("photo").src = window.location.href.slice(0, -1) + ":81/stream";

      };

    </script>

  </body>

</html>